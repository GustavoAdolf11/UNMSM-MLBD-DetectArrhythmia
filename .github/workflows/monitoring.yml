name: Monitoreo Continuo - Data Drift

on:
  workflow_dispatch:  # Solo ejecuciÃ³n manual (requiere datos en producciÃ³n)

jobs:
  monitor-drift:
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“¥ Checkout cÃ³digo
      uses: actions/checkout@v4
    
    - name: ğŸ Configurar Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.11'
    
    - name: ğŸ“¦ Instalar dependencias
      run: |
        pip install evidently pandas numpy
    
    - name: ğŸ” Ejecutar detector de drift
      run: |
        python monitoring/drift_detector.py
      continue-on-error: true
    
    - name: ğŸ“„ Subir reportes de drift
      uses: actions/upload-artifact@v4
      with:
        name: drift-reports-${{ github.run_number }}
        path: monitoring/reports/
        retention-days: 90
    
    - name: ğŸ”” Alertar si hay drift
      run: |
        if [ -f "monitoring/reports/drift_alerts.log" ]; then
          echo "âš ï¸  DRIFT DETECTADO - Revisar reportes"
          cat monitoring/reports/drift_alerts.log
        else
          echo "âœ… No se detectÃ³ drift"
        fi
